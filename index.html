<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart AI Chat</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:Arial,sans-serif;background:#121212;color:#fff;display:flex;height:100vh;overflow:hidden;}
.sidebar{width:200px;background:#1e1e1e;display:flex;flex-direction:column;overflow-y:auto;padding:10px;}
.sidebar button{background:#2c2c2c;color:white;border:none;padding:10px;margin-bottom:5px;border-radius:8px;cursor:pointer;text-align:left;transition:0.2s;}
.sidebar button.active{background:#3a3a3a;font-weight:bold;}
.sidebar button:hover{background:#3a3a3a;}
.main{flex:1;display:flex;flex-direction:column;padding:10px;overflow:hidden;}
.top-buttons{display:flex;gap:5px;margin-bottom:10px;flex-wrap:wrap;}
.top-buttons button{flex:1;padding:8px;border-radius:8px;border:none;background:#0f0;color:#000;cursor:pointer;transition:0.2s;}
.top-buttons button:hover{background:#66ff66;}
.chat{display:none;flex-direction:column;height:100%;}
.chat.active{display:flex;}
.title{font-weight:bold;font-size:20px;text-align:center;margin-bottom:8px;}
.messages{flex:1;overflow-y:auto;padding-right:5px;margin-bottom:5px;}
.msg{margin:5px 0;padding:10px 14px;border-radius:18px;max-width:90%;line-height:1.6;word-wrap:break-word;white-space:pre-wrap;overflow-wrap:break-word;box-shadow:0 2px 4px rgba(0,0,0,0.5);}
.user{background:#2a2a2a;align-self:flex-end;}
.ai{background:#3a3a3a;align-self:flex-start;}
.script-box{background:#1a1a1a;border:1px solid #333;padding:8px;border-radius:8px;max-height:180px;overflow-y:auto;font-family:monospace;color:#0f0;margin-bottom:5px;}
.copy-btn{background:#333;color:white;border:none;padding:4px 8px;border-radius:4px;cursor:pointer;font-size:13px;margin-top:3px;transition:0.2s;}
.copy-btn:hover{background:#0f0;color:#000;}
.input-area{display:flex;gap:5px;}
.input-area input[type=text]{flex:1;padding:10px;border-radius:20px;border:none;outline:none;background:#222;color:white;}
.input-area button{padding:0 14px;border:none;border-radius:20px;background:#0f0;color:#000;font-weight:bold;cursor:pointer;transition:0.2s;}
.input-area button:hover{background:#66ff66;transform:scale(1.05);}
@media(max-width:700px){
  body{flex-direction:column;}
  .sidebar{width:100%;flex-direction:row;overflow-x:auto;overflow-y:hidden;}
  .sidebar button{flex:none;margin-right:5px;margin-bottom:0;}
  .msg{max-width:95%;}
}
</style>
</head>
<body>

<div class="sidebar" id="sidebar">
  <div class="top-buttons">
    <button onclick="addChat()">+ New Chat</button>
    <button onclick="deleteChat()">ðŸ—‘ Delete Chat</button>
  </div>
</div>

<div class="main" id="main"></div>

<script>
let chatCounter=0,chats=[],activeChatId=-1,memory={};

// ADD CHAT
function addChat(){
  const chatId=chatCounter++;
  const chatDiv=document.createElement("div");
  chatDiv.className="chat";
  chatDiv.dataset.id=chatId;
  chatDiv.innerHTML=`
    <div class="title">Chat ${chatId+1}</div>
    <div class="messages"></div>
    <div class="script-box" id="script-${chatId}"></div>
    <div class="input-area">
      <input type="text" placeholder="Type anything..." id="input-${chatId}">
      <button onclick="sendMessage(document.getElementById('input-${chatId}'))">Send</button>
    </div>
  `;
  document.getElementById("main").appendChild(chatDiv);
  chats.push({id:chatId,div:chatDiv});

  const btn=document.createElement("button");
  btn.innerText=`Chat ${chatId+1}`;
  btn.dataset.id=chatId;
  btn.onclick=()=>switchChat(chatId);
  document.getElementById("sidebar").appendChild(btn);

  const input=document.getElementById(`input-${chatId}`);
  input.addEventListener("keydown",(e)=>{if(e.key==="Enter") sendMessage(input);});

  switchChat(chatId);
  postAI("Hello! I am your smart AI. I can solve problems, write code, translate, and chat intelligently.", chatDiv.querySelector(".messages"));
}

// SWITCH CHAT
function switchChat(chatId){
  chats.forEach(c=>c.div.classList.remove("active"));
  document.querySelectorAll("#sidebar button").forEach(b=>b.classList.remove("active"));
  const match = chats.find(c=>c.id===chatId);
  if(!match) return;
  match.div.classList.add("active");
  document.querySelector(`#sidebar button[data-id="${chatId}"]`).classList.add("active");
  activeChatId=chatId;
}

// DELETE CHAT
function deleteChat(){
  if(activeChatId===-1) return;
  const chatObj = chats.find(c=>c.id===activeChatId);
  chatObj.div.remove();
  const btn = document.querySelector(`#sidebar button[data-id="${activeChatId}"]`);
  if(btn) btn.remove();
  chats = chats.filter(c=>c.id!==activeChatId);
  if(chats.length>0) switchChat(chats[0].id);
  else activeChatId=-1;
}

// POST USER
function postUser(text){
  const messages = chats.find(c=>c.id===activeChatId).div.querySelector(".messages");
  const div = document.createElement("div");
  div.className="msg user";
  div.innerText=text;
  messages.appendChild(div);
  messages.scrollTop = messages.scrollHeight;
}

// POST AI
function postAI(text,messagesDiv){
  const div = document.createElement("div");
  div.className="msg ai";

  if(text.startsWith("//") || text.includes("function") || text.includes("console.log")){
    const pre = document.createElement("pre");
    pre.innerText = text;
    const btn = document.createElement("button");
    btn.className = "copy-btn";
    btn.innerText = "Copy";
    btn.onclick = ()=>navigator.clipboard.writeText(text);
    div.appendChild(pre);
    div.appendChild(btn);
  } else {
    div.innerText = text;
  }

  messagesDiv.appendChild(div);
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}

// SEND MESSAGE
async function sendMessage(inputBox){
  const text=inputBox.value.trim();
  if(!text) return;
  postUser(text);
  inputBox.value="";
  const reply=await generateResponse(text);
  postAI(reply,chats.find(c=>c.id===activeChatId).div.querySelector(".messages"));
}

// GENERATE RESPONSE
async function generateResponse(text){
  text=text.trim();
  await new Promise(res=>setTimeout(res,600));

  // MEMORY
  if(text.toLowerCase().includes("my name is")){
    memory.name=text.replace(/my name is/i,"").trim();
    return `Nice to meet you, ${memory.name}! I can remember your preferences and help you better.`;
  }
  if(text.toLowerCase().includes("my name")) return memory.name? `Your name is ${memory.name}.`:"You haven't told me your name yet.";

  // GREETINGS
  if(/hello|hi|hey/i.test(text)) return "Hello! I'm ready to help you with anything â€” math, code, translations, or just chat! ðŸ˜„";

  // MATH
  try{
    let mathText=text.replace(/Ã—|x/g,"*");
    if(/^\d+[\+\-\*\/\d\s\.]+$/.test(mathText)) return "Math result: " + eval(mathText) + ". I can explain steps if needed!";
  }catch(e){}

  // CODE
  if(text.toLowerCase().includes("code") || text.toLowerCase().includes("script")){
    return "// Example JavaScript code\nfor(let i=1;i<=10;i++){console.log(i);}\nClick 'Copy' to use it!";
  }

  // TRANSLATE
  if(text.toLowerCase().includes("translate")){
    return "I can translate text! Example: 'Translate Hello to Spanish'.";
  }

  // GENERAL SMART RESPONSE
  return "Hmmâ€¦ Iâ€™m thinking carefullyâ€¦ I can give detailed answers, suggest code, solve problems, and translate text!";
}

// INIT
addChat();
</script>

</body>
</html>
